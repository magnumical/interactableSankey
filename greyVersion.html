<html>
  <body>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>

    <!-- Diagram with Improved Flow -->
    <div id="sankey_chart" style="width: 800px; height: 600px;"></div>

    <script type="text/javascript">
      google.charts.load("current", { packages: ["sankey"] });
      google.charts.setOnLoadCallback(drawChart);

      function drawChart() {
        var data = new google.visualization.DataTable();
        data.addColumn("string", "From");
        data.addColumn("string", "To");
        data.addColumn("number", "Weight");
        data.addRows([
          // First Layer: Organizations to Fields
          ["CIUSSS West-Central Montreal", "Machine Learning", 700],
          ["CIUSSS West-Central Montreal", "Data Science", 850],
          ["Huawei", "Machine Learning", 1000],
          ["Huawei", "Data Science", 900],
          ["Huawei", "Physiological Computing", 500],
          ["INRS-EMT", "Machine Learning", 900],
          ["INRS-EMT", "Virtual Reality", 800],
          ["INRS-EMT", "Physiological Computing", 500],
          ["UQO--Bruyere Hospital", "Virtual Reality", 800],
          ["UQO--Bruyere Hospital", "Machine Learning", 900],

          // Second Layer: Fields to Subfields
          ["Machine Learning", "Supervised Learning", 1400],
          ["Supervised Learning", "Ensemble Learning", 400],
          ["Supervised Learning", "Regularization", 400],
          ["Supervised Learning", "Federated Learning", 300],
        	["Supervised Learning", "on-GPU Computing", 300],

          ["Machine Learning", "Deep Learning",  600],
          ["Deep Learning", "Large Language Models", 400],
          ["Deep Learning", "Speech Recognition", 200],
          ["Machine Learning", "Interpretable ML", 800],
          ["Interpretable ML", "Model Visualization", 300],
          ["Interpretable ML", "Bias Detection", 300],
          ["Interpretable ML", "Fairness Metrics", 200],
          ["Machine Learning", "Multi-modal ML", 700],
          ["Multi-modal ML", "Cross-domain Learning", 350],
          ["Multi-modal ML", "Data Fusion", 350],
          

          // Data Science Subfields
           ["Data Science", "Data Exploration", 700],
           ["Data Exploration", "Visualization", 500],

          ["Data Science", "Dimensionality Reduction", 300],
          ["Dimensionality Reduction", "Feature Selection", 200],
          ["Dimensionality Reduction", "Principal Component Analysis", 150],
          ["Data Science", "Latent Semantic Analysis", 150],
          ["Data Science", "Statistical Analysis", 300],
          ["Data Exploration", "Data Cleaning", 200],
           ["Data Science", "Storage", 300],
           ["Storage", "SQL/Non-SQL", 300],
          

          // Physiological Computing Subfields
          ["Physiological Computing", "Health Monitoring", 300],
          ["Physiological Computing", "Wearable Sensors", 200],
          ["Physiological Computing", "Biofeedback Systems", 300],
          ["Physiological Computing", "Multi-modal Signal Analysis", 200],

          // Virtual Reality Subfields
          ["Virtual Reality", "Game Development", 400],
          ["Virtual Reality", "Therapeutic Applications", 400],
          ["Virtual Reality", "User Experience Design", 400],
          ["Virtual Reality", "Immersive Experiences", 400],
          ["Immersive Experiences", "Multi-sensory Feedback", 200],
          ["Immersive Experiences", "Interactive Interfaces", 200],
        ]);

        var options = {
          width: 850,
          height: 600,
          sankey: {
            tooltip: { 
              trigger: "focus", // Enable tooltips for customization
              isHtml: true      // Use custom HTML for tooltips
            },
            link: {
              colorMode: "gradient",
              colors: [
                "#000000", "#333333", "#666666", "#999999", "#9c9898",
              ],
            },
            node: {
              colors: [
                "#000000", "#333333", "#666666", "#999999", "#9c9898",
              ],
              label: {
                fontName: "Calibri",
                fontSize: 15,
                 bold: true,
                color: "#000000",
              },
            },
          },
        };

        var chart = new google.visualization.Sankey(
          document.getElementById("sankey_chart")
        );
        chart.draw(data, options);

        // Customize tooltips on hover
        google.visualization.events.addListener(chart, 'onmouseover', function () {
          // Modify tooltip content
          document.querySelectorAll('.google-visualization-tooltip').forEach(tooltip => {
            tooltip.innerHTML = '.'; // Change to '' for an empty tooltip
          });
        });
      }
    </script>
  </body>
</html>
